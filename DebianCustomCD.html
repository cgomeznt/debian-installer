<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html><head>


<link rel="shortcut icon" href="http://wiki.debian.org/htdocs/favicon.ico">
<script type="text/javascript" src="DebianCustomCD_files/bugstatus.js"></script>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="robots" content="index,nofollow">

<title>DebianCustomCD - Debian Wiki</title>
<script type="text/javascript" src="DebianCustomCD_files/common.js"></script>

<script type="text/javascript">
<!--
var search_hint = "Search";
//-->
</script>


<link rel="stylesheet" type="text/css" charset="utf-8" media="all" href="DebianCustomCD_files/common.css">
<link rel="stylesheet" type="text/css" charset="utf-8" media="screen" href="DebianCustomCD_files/screen.css">
<link rel="stylesheet" type="text/css" charset="utf-8" media="print" href="DebianCustomCD_files/print.css">
<link rel="stylesheet" type="text/css" charset="utf-8" media="projection" href="DebianCustomCD_files/projection.css">
<link rel="stylesheet" type="text/css" charset="utf-8" media="all" href="DebianCustomCD_files/debian-wiki-1.css">

<!-- css only for MS IE6/IE7 browsers -->
<!--[if lt IE 8]>
   <link rel="stylesheet" type="text/css" charset="utf-8" media="all" href="/htdocs/debwiki/css/msie.css">
<![endif]-->





<link rel="Start" href="http://wiki.debian.org/FrontPage">
<link rel="Alternate" title="Wiki Markup" href="http://wiki.debian.org/DebianCustomCD?action=raw">
<link rel="Alternate" media="print" title="Print View" href="http://wiki.debian.org/DebianCustomCD?action=print">
<link rel="Search" href="http://wiki.debian.org/FindPage">
<link rel="Index" href="http://wiki.debian.org/TitleIndex">
<link rel="Glossary" href="http://wiki.debian.org/WordIndex">
<link rel="Help" href="http://wiki.debian.org/HelpOnFormatting">
</head><body dir="ltr" lang="en">
<div id="logo"><a href="http://www.debian.org/" title="Debian Homepage"><img src="DebianCustomCD_files/openlogo-50.png" alt="Debian" height="61" width="50"></a></div>
<div id="header">
<div id="wikisection">
<p class="section"><a href="http://wiki.debian.org/" title="Debian Wiki Homepage">Wiki</a></p>
<div id="username"><a href="http://wiki.debian.org/DebianCustomCD?action=login" id="login" rel="nofollow">Login</a></div>
</div>
<div id="navbar">

<ul id="navibar">
<li class="wikilink"><a href="http://wiki.debian.org/FrontPage">FrontPage</a></li><li class="wikilink"><a href="http://wiki.debian.org/RecentChanges">RecentChanges</a></li><li class="wikilink"><a href="http://wiki.debian.org/FindPage">FindPage</a></li><li class="wikilink"><a href="http://wiki.debian.org/HelpContents">HelpContents</a></li><li class="current"><a href="http://wiki.debian.org/DebianCustomCD">DebianCustomCD</a></li>
</ul>

</div>

<form id="searchform" method="get" action="/DebianCustomCD">
<div>
<input name="action" value="fullsearch" type="hidden">
<input name="context" value="180" type="hidden">
<label style="display: none;" for="searchinput">Search:</label>
<input class="disabled" id="searchinput" name="value" value="Search" size="20" onfocus="searchFocus(this)" onblur="searchBlur(this)" onkeyup="searchChange(this)" onchange="searchChange(this)" alt="Search" type="text">
<input disabled="disabled" id="titlesearch" name="titlesearch" value="Titles" alt="Search Titles" type="submit">
<input disabled="disabled" id="fullsearch" name="fullsearch" value="Text" alt="Search Full Text" type="submit">
</div>
</form>
<script type="text/javascript">
<!--// Initialize search form
var f = document.getElementById('searchform');
f.getElementsByTagName('label')[0].style.display = 'none';
var e = document.getElementById('searchinput');
searchChange(e);
searchBlur(e);
//-->
</script>

<div id="logo"><a href="http://www.debian.org/" title="Debian Homepage"><img src="DebianCustomCD_files/openlogo-50.png" alt="Debian" height="61" width="50"></a></div>

<div id="breadcrumbs"><a href="http://wiki.debian.org/" title="Debian Wiki Homepage">Wiki</a><span class="sep">/</span>

</div>

<ul class="editbar"><li><span class="disabled">Immutable Page</span></li><li class="toggleCommentsButton" style="display: none;"><a href="#" class="nbcomment" onclick="toggleComments();return false;">Comments</a></li><li><a class="nbinfo" href="http://wiki.debian.org/DebianCustomCD?action=info" rel="nofollow">Info</a></li><li><a class="nbattachments" href="http://wiki.debian.org/DebianCustomCD?action=AttachFile" rel="nofollow">Attachments</a></li><li>
<form class="actionsmenu" method="GET" action="/DebianCustomCD">
<div>
    
    <select name="action" onchange="if ((this.selectedIndex != 0) &amp;&amp;
                      (this.options[this.selectedIndex].disabled == false)) {
                this.form.submit();
            }
            this.selectedIndex = 0;">
        <option selected="selected" value="show">More Actions:</option><option value="raw">Raw Text</option>
<option value="print">Print View</option>
<option value="RenderAsDocbook">Render as Docbook</option>
<option value="refresh">Delete Cache</option>
<option value="show" disabled="disabled" class="disabled">------------------------</option>
<option value="SpellCheck">Check Spelling</option>
<option value="LikePages">Like Pages</option>
<option value="LocalSiteMap">Local Site Map</option>
<option value="show" disabled="disabled" class="disabled">------------------------</option>
<option value="RenamePage" disabled="disabled" class="disabled">Rename Page</option>
<option value="DeletePage" disabled="disabled" class="disabled">Delete Page</option>
<option value="show" disabled="disabled" class="disabled">------------------------</option>
<option value="show" disabled="disabled" class="disabled">Subscribe User</option>
<option value="show" disabled="disabled" class="disabled">------------------------</option>
<option value="show" disabled="disabled" class="disabled">Remove Spam</option>
<option value="show" disabled="disabled" class="disabled">Revert to this revision</option>
<option value="PackagePages">Package Pages</option>
<option value="show" disabled="disabled" class="disabled">------------------------</option>
<option value="Load">Load</option>
<option value="Save">Save</option>
<option value="SlideShow">SlideShow</option>
    </select>
    
    
</div>
<script type="text/javascript">
<!--// Init menu
actionsMenuInit('More Actions:');
//-->
</script>
</form>
</li></ul>

<h1 id="locationline">


<ul id="pagelocation">
<li><a class="backlink" href="http://wiki.debian.org/DebianCustomCD?action=fullsearch&amp;context=180&amp;value=linkto%3A%22DebianCustomCD%22" rel="nofollow" title="Click to do a full-text search for this title">DebianCustomCD</a></li>
</ul>

</h1>
</div>

<div id="page" dir="ltr" lang="en">
<div dir="ltr" id="content" lang="en"><span class="anchor" id="top"></span>
<span class="anchor" id="line-1"></span><span class="anchor" id="line-2"></span><span class="anchor" id="line-3"></span><p class="line867"><small>Translation(s): <a href="http://wiki.debian.org/DebianCustomCD">English</a> - <a href="http://wiki.debian.org/ru/DebianCustomCD">Russian(Русский)</a> </small> <span class="anchor" id="line-4"></span></p><hr><p class="line874"> <span class="anchor" id="line-5"></span>
</p><h1 id="Building_a_Custom_Debian_CD_Set">Building a Custom Debian CD Set</h1>
<span class="anchor" id="line-6"></span><p class="line867">
</p><h2 id="An_Easier_Alternative">An Easier Alternative</h2>
<span class="anchor" id="line-7"></span><p class="line862">One possible "alternative" to this procedure is to use <a href="http://wiki.debian.org/Simple-CDD">Simple-CDD</a>.
If it does everything you need for your custom CD, then there is no
reason (except curiosity) to go through the rest of this article. <span class="anchor" id="line-8"></span><span class="anchor" id="line-9"></span></p><p class="line867">
</p><h2 id="Introduction">Introduction</h2>
<span class="anchor" id="line-10"></span><p class="line874">This page
describes how to create a partial debian mirror and the steps used to
create a custom debian install cd using that mirror. This document
shows how to use packages gathered from a prototype system's apt cache
as well as a download script that starts with a list of packages and
fetches the appropriate versions. The instructions here assume i386 but
should work for any architecture simply by replacing i386 in the
instructions with the architecture of your choice. <span class="anchor" id="line-11"></span><span class="anchor" id="line-12"></span></p><p class="line867">
</p><h2 id="Quick_Overview.2C_Using_Apt.2C_Binary_Only">Quick Overview, Using Apt, Binary Only</h2>
<span class="anchor" id="line-13"></span><span class="anchor" id="line-14"></span><p class="line867"><strong>NOTE</strong>
Using a full mirror, or a mostly full mirror is best practice. You
should only use a partial mirror if you absolutely must (e.g. due to
disk constraints) and realize that it is unsupported. <span class="anchor" id="line-15"></span><span class="anchor" id="line-16"></span></p><p class="line867">
</p><h3 id="Create_a_mirror_of_the_Debian_archive_for_Apt">Create a mirror of the Debian archive for Apt</h3>
<span class="anchor" id="line-17"></span><p class="line867">
</p><h4 id="Option_1:_Using_debmirror">Option 1: Using debmirror</h4>
<span class="anchor" id="line-18"></span><span class="anchor" id="line-19"></span><p class="line862">Frans Pop has created a wrapper script for this which is <a class="http" href="http://alioth.debian.org/%7Efjp/debmirror/">available from alioth</a>.  A README explains how to use it.  This is the preferred approach. <span class="anchor" id="line-20"></span><span class="anchor" id="line-21"></span></p><p class="line867">
</p><h4 id="Option_2:_Create_a_partial_mirror_of_the_Debian_archive">Option 2: Create a partial mirror of the Debian archive</h4>
<span class="anchor" id="line-22"></span><ul><li><p class="line862">Download a <a href="http://wiki.debian.org/DebianInstaller">DebianInstaller</a> network install cd (netinst.iso) from here <a class="http" href="http://www.debian.org/CD/netinst/">http://www.debian.org/CD/netinst/</a> <span class="anchor" id="line-23"></span></p></li><li><p class="line862">Install Debian on a prototype system <em>(Optional)</em> <span class="anchor" id="line-24"></span></p></li><li><p class="line891"><a href="http://wiki.debian.org/apt-get">apt-get</a> packages (or you may use <a href="http://wiki.debian.org/Aptitude">Aptitude</a> if you prefer) -&gt; <em>hint: you don't have to install, just download to the apt cache, as long apt-move works.</em> <span class="anchor" id="line-25"></span></p></li><li><p class="line891"><a href="http://wiki.debian.org/AptMove">AptMove</a> to a directory of your choice  <span class="anchor" id="line-26"></span></p></li><li><p class="line862">Create a <tt>pool</tt> directory on the filesystem where you will build your new cd. <span class="anchor" id="line-27"></span></p></li><li>Copy the pool directory from network install cd to the directory you just created. <span class="anchor" id="line-28"></span></li><li><p class="line862">Copy from the directory to which you sent the files using <tt>apt-move</tt> to the <tt>pool</tt> directory (you could just <a href="http://wiki.debian.org/AptMove">AptMove</a> to the pool directory). <span class="anchor" id="line-29"></span></p></li><li><p class="line862">Get <tt>installer-i386</tt> from a debian mirror which is from the same release of <a href="http://wiki.debian.org/DebianInstaller">DebianInstaller</a> as your network install cd (unless you also build the installer and associated packages). <span class="anchor" id="line-30"></span></p></li><li><p class="line862">Get <tt>overrides.&lt;dist&gt;.</tt> files from <em><a class="http" href="http://%3Cmirror%3E/debian/indices">http://&lt;mirror&gt;/debian/indices</a></em> <span class="anchor" id="line-31"></span></p></li><li>Place in your debian-dir (i.e. the same directory as the pool directory you created above). <span class="anchor" id="line-32"></span></li><li><p class="line891"><tt>gunzip</tt> the overrides in the indices directory (you should probably keep the original gzipped versions too) <span class="anchor" id="line-33"></span></p></li><li>Generate packages files. <span class="anchor" id="line-34"></span><ul><li><p class="line862">generate <a href="http://wiki.debian.org/DebianInstaller">DebianInstaller</a> packages files: <span class="anchor" id="line-35"></span></p><ul><li><p class="line891"><a href="http://wiki.debian.org/DebianInstaller">DebianInstaller</a> lives in <tt>&lt;debian-dir&gt;/dists/&lt;dist&gt;/main/debian-installer/binary-i386</tt>, therefore  <span class="anchor" id="line-36"></span></p><ul><li><p class="line862">create the appropriate subdirectories (e.g. <tt>mkdir&nbsp;-p&nbsp;/debian/dists/sarge/main/debian-installer/binary-i386</tt>). <span class="anchor" id="line-37"></span></p></li></ul></li><li><p class="line862">in a directory for your scripts and configuration files for this project create an apt.conf such as the one at <a href="http://wiki.debian.org/DebianCustomCD/PoolAptConf">DebianCustomCD/PoolAptConf</a> <span class="anchor" id="line-38"></span></p></li><li><p class="line862">create a file named yourcdname-di.conf (or anything else, just substitute your filename as appropriate), such as the one at <a href="http://wiki.debian.org/DebianCustomCD/PoolDebianInstallerPackagesGzConf">DebianCustomCD/PoolDebianInstallerPackagesGzConf</a>, creating the directories described therein <span class="anchor" id="line-39"></span></p></li><li><p class="line862">execute the command <tt>&nbsp;apt-ftparchive&nbsp;-c&nbsp;apt.conf&nbsp;generate&nbsp;yourcdname-di.conf&nbsp;</tt> <span class="anchor" id="line-40"></span></p></li></ul></li><li>repeat for binary-i386: <span class="anchor" id="line-41"></span><ul><li><p class="line862">create another file named yourcdname.conf (such as the one at <a href="http://wiki.debian.org/DebianCustomCD/PoolPackagesGzConf">DebianCustomCD/PoolPackagesGzConf</a>) <span class="anchor" id="line-42"></span></p></li><li><p class="line862">execute the command <tt>&nbsp;apt-ftparchive&nbsp;-c&nbsp;apt.conf&nbsp;generate&nbsp;yourcdname.conf&nbsp;</tt> <span class="anchor" id="line-43"></span><span class="anchor" id="line-44"></span></p></li></ul></li></ul></li></ul><p class="line867">
</p><h3 id="Create_the_actual_CD_set">Create the actual CD set</h3>
<span class="anchor" id="line-45"></span><p class="line862">Note that you must have a mirror of the debian archive which is usable by <a class="nonexistent" href="http://wiki.debian.org/AptGet">AptGet</a> and which has the <a href="http://wiki.debian.org/DebianInstaller">DebianInstaller</a> binaries. <span class="anchor" id="line-46"></span><span class="anchor" id="line-47"></span></p><ul><li>Create the list of packages you want on the cd (probably just a list of files in your pool dir). <span class="anchor" id="line-48"></span></li><li>Assuming you have debian-cd installed, follow the directions in /usr/share/debian-cd. <span class="anchor" id="line-49"></span></li><li>If
you find you are missing dependencies, download the packages into your
pool dir to correct that, regenerate your packages files, and start the
debian-cd instructions over again (you may need to exit the shell you
started the procedure in because debian-cd alters the environment while
it builds the cd [set]). <span class="anchor" id="line-50"></span></li><li>Assuming successful completion of the CD building procedure, burn your CD and test. <span class="anchor" id="line-51"></span></li></ul><p class="line867"></p><hr><p class="line874"> <span class="anchor" id="line-52"></span><span class="anchor" id="line-53"></span></p><p class="line867">
</p><h2 id="Detailed_Instructions">Detailed Instructions</h2>
<span class="anchor" id="line-54"></span><span class="anchor" id="line-55"></span><p class="line867"><strong>NOTE</strong>
Using a full mirror, or a mostly full mirror is best practice. You
should only use a partial mirror if you absolutely must (e.g. due to
disk constraints) and realize that it is unsupported. <span class="anchor" id="line-56"></span><span class="anchor" id="line-57"></span></p><p class="line867">
</p><h3 id="Preferred:_Use_debmirror">Preferred: Use debmirror</h3>
<span class="anchor" id="line-58"></span><span class="anchor" id="line-59"></span><p class="line862">Frans Pop has created a wrapper script for this which is <a class="http" href="http://alioth.debian.org/%7Efjp/debmirror/">available from alioth</a>.
A README explains how to use it. This is the preferred approach if you
have a high bandwidth connection and 30-40 GB of hard drive space to
spare. <span class="anchor" id="line-60"></span><span class="anchor" id="line-61"></span></p><p class="line867">
</p><h3 id="Optional:_Create_a_partial_mirror_of_the_Debian_archive_for_Apt_.28optional.29">Optional: Create a partial mirror of the Debian archive for Apt (optional)</h3>
<span class="anchor" id="line-62"></span><p class="line867">
</p><h4 id="A1._Getting_Your_Packages.2C_Option_1">1. Getting Your Packages, Option 1</h4>
<span class="anchor" id="line-63"></span><p class="line862">Pro: Will automatically resolve and download dependencies<br>
 <span class="anchor" id="line-64"></span>Con: Only works for packages and dependencies not already installed <span class="anchor" id="line-65"></span>
</p><h5 id="Get_Your_Base_System_.28Optional.29">Get Your Base System (Optional)</h5>
<span class="anchor" id="line-66"></span><p class="line874">The
following will get a you system with no other packages installed, which
can make figuring out what packages to include in your pool directory
easier. (If you use apt-get to download the packages you want on you CD
you will find that the dependencies for the packages will only also be
downloaded if they are not already installed. If you are using another
method figure out the list of packages to download then you don't need
to worry about this). <span class="anchor" id="line-67"></span><span class="anchor" id="line-68"></span></p><ul><li><p class="line862">Download a <a href="http://wiki.debian.org/DebianInstaller">DebianInstaller</a> network install CD (netinst.iso) from [WWW] <a class="http" href="http://www.debian.org/CD/netinst/">http://www.debian.org/CD/netinst/</a>. <span class="anchor" id="line-69"></span></p></li><li>Use this install cd and install a base system on some computer. <span class="anchor" id="line-70"></span></li><li><p class="line862">Copy the network install cd to the filesystem where you'll be doing your work (e.g. <tt>/home/debian</tt>). <span class="anchor" id="line-71"></span><span class="anchor" id="line-72"></span></p></li></ul><p class="line867">
</p><h5 id="Getting_Additional_Packages.2C_Option_1">Getting Additional Packages, Option 1</h5>
<span class="anchor" id="line-73"></span><span class="anchor" id="line-74"></span><ul><li><p class="line862">Use <a href="http://wiki.debian.org/Aptitude">Aptitude</a> or <a class="nonexistent" href="http://wiki.debian.org/AptGet">AptGet</a> to download the packages you want on the system and CD. <span class="anchor" id="line-75"></span></p></li><li><p class="line862">Install <a href="http://wiki.debian.org/AptMove">AptMove</a> (e.g. <tt>apt-get&nbsp;install&nbsp;apt-move</tt>) <span class="anchor" id="line-76"></span></p></li><li><p class="line862">Modify <tt>apt-move.conf</tt> to use your pool directory as its local mirror (<tt>LOCALDIR</tt>) <span class="anchor" id="line-77"></span></p></li><li><p class="line891"><a href="http://wiki.debian.org/AptMove">AptMove</a> your other packages to your pool directory (e.g. <tt>/home/debian/pool</tt>) by typing: <tt>apt-move&nbsp;update</tt> <span class="anchor" id="line-78"></span><span class="anchor" id="line-79"></span></p></li></ul><p class="line867">
</p><h5 id="Getting_Additional_Packages.2C_Option_2">Getting Additional Packages, Option 2</h5>
<span class="anchor" id="line-80"></span><ul><li><p class="line862">Use <a href="http://wiki.debian.org/Aptitude">Aptitude</a> or <a class="nonexistent" href="http://wiki.debian.org/AptGet">AptGet</a> to download the packages you want on the system and cd. <span class="anchor" id="line-81"></span></p></li><li><p class="line862">Get <a href="http://wiki.debian.org/AptMove">AptMove</a> (e.g. <tt>apt-get&nbsp;install&nbsp;apt-move</tt>) <span class="anchor" id="line-82"></span></p></li><li><p class="line862">Modify <tt>apt-move.conf</tt> to use a temporary directory as its local mirror (<tt>LOCALDIR</tt>) <span class="anchor" id="line-83"></span></p></li><li><p class="line891"><a href="http://wiki.debian.org/AptMove">AptMove</a> your other packages to a temporary directory (e.g. <tt>/home/debian/tmp</tt>) by typing: <tt>apt-move&nbsp;update</tt> <span class="anchor" id="line-84"></span></p></li><li><p class="line862">Use a script such as the one at <a href="http://wiki.debian.org/DebianCustomCD/MovePoolScript">DebianCustomCD/MovePoolScript</a> to copy packages from the temporary directory to your pool directory (e.g. <tt>/home/debian/pool</tt>).  <em>This
is my preferred mode of operation because I have more control over what
happens to what apt-move calls the 'mirror' (the pool directory),
especially when building cd's for testing or unstable, which change
quickly.</em> <span class="anchor" id="line-85"></span><span class="anchor" id="line-86"></span></p></li></ul><p class="line867">
</p><h5 id="Optional_Order">Optional Order</h5>
<span class="anchor" id="line-87"></span><p class="line874">Instead of
copying the network install cd first, copy your Apt cache to your
desired pool directory first (as above), then use the above script to
copy from the network install pool directory to your pool directory. <span class="anchor" id="line-88"></span><span class="anchor" id="line-89"></span></p><p class="line867">
</p><h5 id="Notes_on_the_use_of_AptMove">Notes on the use of AptMove</h5>
<span class="anchor" id="line-90"></span><p class="line862">You will need to change <tt>apt-move.conf</tt> to point to your mirror.  See <a href="http://wiki.debian.org/AptMove">AptMove</a> for details (or <tt>man&nbsp;apt-move</tt>). <span class="anchor" id="line-91"></span>
</p><h4 id="A1._Getting_Your_Packages.2C_Option_2">1. Getting Your Packages, Option 2</h4>
<span class="anchor" id="line-92"></span><p class="line862">Pro: Works for all packages<br>
 <span class="anchor" id="line-93"></span>Con: You have to figure out the dependencies yourself <span class="anchor" id="line-94"></span><span class="anchor" id="line-95"></span></p><ul><li>Figure out what packages you'll need <span class="anchor" id="line-96"></span></li><li><p class="line862">Download
them individually (if you make a list and use wget on the list, it
wouldn't be as painful) into the pool directory in the filesystem where
you'll be doing your work (e.g. <tt>/home/debian/pool</tt>). <span class="anchor" id="line-97"></span></p></li><li>Don't forget any dependencies (by hand! ugh!). <span class="anchor" id="line-98"></span></li></ul><p class="line867">
</p><h4 id="A1._Getting_Your_Packages.2C_Option_3">1. Getting Your Packages, Option 3</h4>
<span class="anchor" id="line-99"></span><p class="line862">Pro: Works for all packages<br>
 <span class="anchor" id="line-100"></span>Con: You have to learn <a href="http://wiki.debian.org/Germinate">Germinate</a> and download a script <span class="anchor" id="line-101"></span><span class="anchor" id="line-102"></span></p><ul><li><p class="line862">Use <a href="http://wiki.debian.org/Germinate">Germinate</a> (available in Etch) to generate a list of packages and their dependencies based on an initial 'seed' (list of packages).  <span class="anchor" id="line-103"></span></p></li><li><p class="line862">Use the perl script at <a href="http://wiki.debian.org/DebianCustomCD/CustomDownload">DebianCustomCD/CustomDownload</a> <span class="anchor" id="line-104"></span></p></li><li><p class="line862">For more information on generating the list of packages using <tt>germinate</tt> look at the <a href="http://wiki.debian.org/Germinate">Germinate</a> page in this wiki. <span class="anchor" id="line-105"></span><span class="anchor" id="line-106"></span></p></li></ul><p class="line867">
</p><h4 id="A2._Get_DebianInstaller_Binaries">2. Get DebianInstaller Binaries</h4>
<span class="anchor" id="line-107"></span><ul><li><p class="line862">The <a href="http://wiki.debian.org/DebianInstaller">DebianInstaller</a>
binaries consist of files in and directory called installer-i386 and
special packages in the Debian archive known as udebs (because they end
with .udeb, as in micro-deb, unlike regular packages which end in .deb)
<span class="anchor" id="line-108"></span><span class="anchor" id="line-109"></span></p></li></ul><p class="line867"><em>Make sure you get the udebs that correspond with the version of the <span class="anchor" id="line-110"></span><a href="http://wiki.debian.org/DebianInstaller">DebianInstaller</a> you downloaded to/from the installer-i386 <span class="anchor" id="line-111"></span>directory.  Using the <a href="http://wiki.debian.org/Germinate">Germinate</a> method above and immediately <span class="anchor" id="line-112"></span>downloading installer-i386 is one method while using a stable <span class="anchor" id="line-113"></span>distribution and copying the udebs from the install cd, and <span class="anchor" id="line-114"></span>downloading the appropriate installer-i386 is another.  There are others.</em> <span class="anchor" id="line-115"></span><span class="anchor" id="line-116"></span></p><p class="line867">
</p><h5 id="DebianInstaller.2C_Option_1">DebianInstaller, Option 1</h5>
<span class="anchor" id="line-117"></span><ol type="1"><li><p class="line862">Download installer-i386 from a <a href="http://wiki.debian.org/Debian">Debian</a> mirror (e.g. <a class="ftp" href="ftp://ftp.debian.org/debian/dists/sarge/main/current">ftp://ftp.debian.org/debian/dists/sarge/main/current</a>) <span class="anchor" id="line-118"></span></p></li><li>You should have the correct udebs in your tree if you have <span class="anchor" id="line-119"></span>downloaded the installer-i386 from the same distribution as your <span class="anchor" id="line-120"></span>network install cd, or you downloaded installer-i386 from the same <span class="anchor" id="line-121"></span>distribution (and immediately before or after) downloading the <span class="anchor" id="line-122"></span><p class="line862">packages (including udebs) using <a href="http://wiki.debian.org/Germinate">Germinate</a> <span class="anchor" id="line-123"></span><span class="anchor" id="line-124"></span></p></li></ol><p class="line867">
</p><h5 id="DebianInstaller.2C_Option_2">DebianInstaller, Option 2</h5>
<span class="anchor" id="line-125"></span><p class="line867"><em>The really isn't recommended but may be necessary in some cases</em> <span class="anchor" id="line-126"></span><span class="anchor" id="line-127"></span></p><ol type="1"><li><p class="line862">Build <a href="http://wiki.debian.org/DebianInstaller">DebianInstaller</a> (which also downloads udebs).  See <a href="http://wiki.debian.org/DebianInstaller/Build">DebianInstaller/Build</a>. <span class="anchor" id="line-128"></span></p></li><li>Copy udebs to your pool directory from <span class="anchor" id="line-129"></span>debian-installer/installer/build/apt.udeb, using something like the <span class="anchor" id="line-130"></span><p class="line862">script at <a href="http://wiki.debian.org/DebianCustomCD/MoveInstallerUdebs">DebianCustomCD/MoveInstallerUdebs</a> <span class="anchor" id="line-131"></span><span class="anchor" id="line-132"></span><span class="anchor" id="line-133"></span></p></li></ol><p class="line867">
</p><h4 id="A3._Make_Mirror_Recognizable_to_Apt">3. Make Mirror Recognizable to Apt</h4>
<span class="anchor" id="line-134"></span><p class="line867">
</p><h5 id="Download_files_need_by_apt-ftparchive">Download files need by apt-ftparchive</h5>
<span class="anchor" id="line-135"></span><ol type="1"><li><p class="line862">Download <tt>/debian/indices/overrides.&lt;dists&gt;.*.gz</tt> for your distro (e.g. for sarge, <tt>/debian/indices/overrides.sarge.*.gz</tt>) into the directory <tt>indices</tt> which is in the same root directory as your <tt>pool</tt> (mirror) directory (e.g. <tt>/debian/pool</tt>, so <tt>/debian/indices</tt>). <span class="anchor" id="line-136"></span></p></li><li>Gunzip the overrides, keeping the compressed files. <span class="anchor" id="line-137"></span><span class="anchor" id="line-138"></span><span class="anchor" id="line-139"></span></li></ol><p class="line867">
</p><h4 id="A4.__Generate_Package_lists_and_Release_files_for_your_.27distribution.27">4.  Generate Package lists and Release files for your 'distribution'</h4>
<span class="anchor" id="line-140"></span><ul><li><p class="line862">generate <a href="http://wiki.debian.org/DebianInstaller">DebianInstaller</a> packages files: <span class="anchor" id="line-141"></span></p><ul><li><p class="line891"><a href="http://wiki.debian.org/DebianInstaller">DebianInstaller</a> lives in <tt>&lt;debian-dir&gt;/dists/&lt;dist&gt;/main/debian-installer/binary-i386</tt> <span class="anchor" id="line-142"></span></p></li><li><p class="line862">so create the appropriate subdirectories (e.g. <tt>mkdir&nbsp;-p&nbsp;/debian/dists/sarge/main/debian-installer/binary-i386</tt>). <span class="anchor" id="line-143"></span></p></li></ul></li><li><p class="line862">in a directory (e.g. custom-cd-scripts) for your scripts and config files for this create an apt.conf such as the one at <a href="http://wiki.debian.org/DebianCustomCD/PoolAptConf">DebianCustomCD/PoolAptConf</a> <span class="anchor" id="line-144"></span></p></li><li><p class="line862">create a file named yourcdname-di.conf (or anything else, just substitute your filename as appropriate), such as the one at <a href="http://wiki.debian.org/DebianCustomCD/PoolDebianInstallerPackagesGzConf">DebianCustomCD/PoolDebianInstallerPackagesGzConf</a>, creating the directories described therein <span class="anchor" id="line-145"></span></p></li><li><p class="line891"><tt>ArchiveDir</tt> is the parent directory of your <tt>pool</tt> and <tt>dists</tt> subdirectories <span class="anchor" id="line-146"></span></p></li><li><p class="line891"><tt>OverrideDir</tt> is the directory which contains your overrides <span class="anchor" id="line-147"></span></p></li><li><p class="line891"><tt>CacheDir</tt> is your temporary (cache) directory. <span class="anchor" id="line-148"></span></p></li><li><p class="line862">Under <tt>TreeDefault</tt>, <tt>Directory</tt> indicates the location of your pool (archive) directory <span class="anchor" id="line-149"></span></p></li><li><p class="line862">The path in quotes after <tt>BinDirectory</tt> (and before the curly brace), is the location, relative to <tt>ArchiveDir</tt> of the binary packages (well actually the alphabetic directories, which have the package directories under them). <span class="anchor" id="line-150"></span></p></li><li><p class="line862">Under <tt>BinDirectory</tt>, <tt>Packages</tt>
is the full pathname of the Packages (without .gz even if you are
creating compressed files) file you are creating (in this case the
debian-installer <tt>Packages.gz</tt>). <span class="anchor" id="line-151"></span></p></li><li><p class="line862">execute the command in the directory containing the <tt>pool</tt> and <tt>dists</tt> directories <span class="anchor" id="line-152"></span><span class="anchor" id="line-153"></span><span class="anchor" id="line-154"></span></p><pre><span class="anchor" id="line-1"></span>    apt-ftparchive -c custom-cd-scripts/apt.conf generate custom-cd-scripts/customcd-di.conf</pre><span class="anchor" id="line-155"></span></li><li><p class="line862">repeat for the <tt>binary-i386</tt> directories (under <tt>main</tt>, <tt>contrib</tt>, <tt>non-free</tt>): <span class="anchor" id="line-156"></span></p><ul><li><p class="line862">create a file named yourcdname.conf such as the one at <a href="http://wiki.debian.org/DebianCustomCD/PoolPackagesGzConf">DebianCustomCD/PoolPackagesGzConf</a> <span class="anchor" id="line-157"></span></p><ul><li><p class="line862">execute the command <tt>&nbsp;apt-ftparchive&nbsp;-c&nbsp;apt.conf&nbsp;generate&nbsp;yourcdname.conf&nbsp;</tt> <span class="anchor" id="line-158"></span></p></li></ul></li></ul></li><li><p class="line862">Generate <tt>Release</tt> file: <span class="anchor" id="line-159"></span></p><ul><li>execute the following command in the directory containing the <span class="anchor" id="line-160"></span><p class="line891"><tt>pool</tt> and <tt>dists</tt> directories: {{{ apt-ftparchive -c <span class="anchor" id="line-161"></span>custom-cd-scripts/apt.conf release dists/sarge &gt;dists/sarge/Release <span class="anchor" id="line-162"></span>}}} <span class="anchor" id="line-163"></span><span class="anchor" id="line-164"></span></p></li></ul></li></ul><p class="line867">
</p><h3 id="Create_the_actual_CD_set-1">Create the actual CD set</h3>
<span class="anchor" id="line-165"></span><p class="line862">Note that you must have a mirror of the debian archive which is usable by <a class="nonexistent" href="http://wiki.debian.org/AptGet">AptGet</a> and which has the <a href="http://wiki.debian.org/DebianInstaller">DebianInstaller</a> binaries. <span class="anchor" id="line-166"></span><span class="anchor" id="line-167"></span></p><p class="line867">
</p><h4 id="Create_List_Of_Files_To_Include_On_CD">Create List Of Files To Include On CD</h4>
<span class="anchor" id="line-168"></span><ul><li>You can do this by hand, or if you just want to include the latest <span class="anchor" id="line-169"></span><p class="line862">versions of everything in your mirror (<tt>pool</tt>) directory, you can <span class="anchor" id="line-170"></span>use something like the script at <a href="http://wiki.debian.org/DebianCustomCD/ListPackagesInMirror">DebianCustomCD/ListPackagesInMirror</a> <span class="anchor" id="line-171"></span><span class="anchor" id="line-172"></span></p></li><li class="gap">Alternatively combine the approaches and remove packages you don't <span class="anchor" id="line-173"></span><ul><li style="list-style-type: none;">want.  Note that dependencies are resolved for any debs (but not <span class="anchor" id="line-174"></span>udebs), so don't be afraid to removing the lib packages (that way <span class="anchor" id="line-175"></span>only what you actually need, or manually want to include, are added <span class="anchor" id="line-176"></span>to the cd), except for lib*-udeb* which should be left so the <span class="anchor" id="line-177"></span>installer works correctly. <span class="anchor" id="line-178"></span><span class="anchor" id="line-179"></span></li></ul></li></ul><p class="line867">
</p><h4 id="Install_and_Configure_debian-cd">Install and Configure debian-cd</h4>
<span class="anchor" id="line-180"></span><ul><li><p class="line862">Download and install the debian-cd package (e.g. <tt>apt-get&nbsp;install&nbsp;debian-cd</tt>) <span class="anchor" id="line-181"></span></p></li><li><p class="line891"><tt>cd&nbsp;/usr/share/debian-cd</tt> and edit <tt>CONF.sh</tt> <span class="anchor" id="line-182"></span><span class="anchor" id="line-183"></span></p></li><li class="gap">Note
that INSTALLER_CD is set to 1. This includes
tasks/debian-installer+kernel, and some other 'magic'. Just make sure
the list of packages you produced as instructed above has all the
kernel and debian-installer packages, and that
tasks/debian-installer+kernel doesn't list any outdated packages. <span class="anchor" id="line-184"></span></li><li><p class="line862">Also note that the directories must all be on the same filesystem (except those under <tt>/usr/share/debian-cd</tt>) <span class="anchor" id="line-185"></span></p></li></ul><p class="line867">
</p><h4 id="The_Remainder_of_the_debian-cd_Procedure">The Remainder of the debian-cd Procedure</h4>
<span class="anchor" id="line-186"></span><p class="line874">This assumes you have both binaries and sources.  If you want binary only read the README for debian-cd. <span class="anchor" id="line-187"></span><span class="anchor" id="line-188"></span></p><p class="line867"><strong>NOTE</strong> Frans Pop has developed a relatively easy to use wrapper script for use with debian-cd that works with the current version of <tt>debian-cd</tt>. It was the mybuild.sh script previously available in <a class="http" href="http://alioth.debian.org/%7Efjp/debian-cd/">available from alioth</a> and has been <span class="anchor" id="line-189"></span>included in <a class="http" href="http://svn.debian.org/wsvn/debian-cd/trunk/">debian-cd itself</a>
(starting with version 3.0.5). This script has been further improved
and is renamed to easy-build.sh. README.easy-build file explains how to
use it. <span class="anchor" id="line-190"></span><span class="anchor" id="line-191"></span></p><p class="line867"><span class="anchor" id="line-192"></span><span class="anchor" id="line-193"></span></p><p class="line867"><strong>WARNING</strong> <strong>The
following is very out-of-date and will not work with recent versions of
debian-cd (3.0.X onwards). I hope to find time to fix it, but can't
promise anything...</strong> -- <a href="http://wiki.debian.org/SteveMcIntyre">SteveMcIntyre</a> <span class="anchor" id="line-194"></span><span class="anchor" id="line-195"></span></p><ul><li><p class="line862">Start a new shell (e.g.<strong> <tt>bash</tt>) </strong> <span class="anchor" id="line-196"></span></p></li><li><p class="line862">Source <tt>CONF.sh</tt>, e.g. by typing: <span class="anchor" id="line-197"></span><span class="anchor" id="line-198"></span><span class="anchor" id="line-199"></span></p><pre><span class="anchor" id="line-1-1"></span>    . CONF.sh</pre><span class="anchor" id="line-200"></span></li><li><p class="line891"><tt>make&nbsp;distclean</tt> <span class="anchor" id="line-201"></span></p></li><li><p class="line891"><tt>make&nbsp;mirrorcheck-binary</tt> <span class="anchor" id="line-202"></span></p></li><li><p class="line891"><tt>make&nbsp;mirrorcheck-source</tt> <span class="anchor" id="line-203"></span></p><ul><li><p class="line862">If there are any missing dependencies, download them into your pool directory, regenerate your packages file, and start the <tt>debian-cd</tt> part of this procedure over again. <span class="anchor" id="line-204"></span></p></li></ul></li><li><p class="line891"><tt>make&nbsp;status</tt> <span class="anchor" id="line-205"></span></p><ul><li><p class="line862">This should never fail.  If it does you're best determining what went wrong, but if you insist you can try <tt>make&nbsp;correctstatus</tt> <span class="anchor" id="line-206"></span></p></li></ul></li><li><p class="line891"><tt>make&nbsp;list&nbsp;TASK=tasks/customcd</tt> <span class="anchor" id="line-207"></span></p></li><li><p class="line891"><tt>make&nbsp;bootable</tt> <span class="anchor" id="line-208"></span></p><ul><li>Makes the binary cd(s?) bootable. <span class="anchor" id="line-209"></span></li></ul></li><li><p class="line891"><tt>make&nbsp;md5list</tt> <span class="anchor" id="line-210"></span></p><ul><li>Create the md5 checksums so that the cd can be verified. <span class="anchor" id="line-211"></span></li></ul></li><li><p class="line891"><tt>make&nbsp;images</tt> <span class="anchor" id="line-212"></span></p><ul><li>Actually makes the cd <span class="anchor" id="line-213"></span></li></ul></li><li><p class="line891"><tt>make&nbsp;imagesums</tt> <span class="anchor" id="line-214"></span></p><ul><li>the md5 checksum for the actual cd images <span class="anchor" id="line-215"></span></li></ul></li><li>Burn it/them. <span class="anchor" id="line-216"></span></li></ul><span class="anchor" id="bottom"></span></div><div id="pagebottom"></div>
</div>


<div id="footer">
<p id="pageinfo" class="info" dir="ltr" lang="en">DebianCustomCD  (last edited 2011-02-11 06:02:17 by <span title="gsimmons @ 124.168.125.161[124.168.125.161]"><a href="http://wiki.debian.org/GeoffSimmons" title="gsimmons @ 124.168.125.161[124.168.125.161]">GeoffSimmons</a></span>)</p>

<ul id="credits">
<li><a href="http://moinmo.in/" title="This site uses the MoinMoin Wiki software.">MoinMoin Powered</a></li><li><a href="http://moinmo.in/Python" title="MoinMoin is written in Python.">Python Powered</a></li><li><a href="http://validator.w3.org/check?uri=referer" title="Click here to validate this page.">Valid HTML 4.01</a></li><li>Debian Wiki <a href="http://wiki.debian.org/Teams/DebianWiki">team</a>, <a href="http://bugs.debian.org/wiki.debian.org">bugs</a> and <a href="http://git.debian.org/?p=collab-maint/wiki.debian.org.git;a=summary">config</a> available.</li><li>Hosting provided by <a href="http://www.dg-i.net/">Dembach Goo Informatik GmbH &amp; Co KG</a></li>
</ul>


</div>
</body></html>